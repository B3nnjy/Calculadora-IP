(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const t of i)if(t.type==="childList")for(const d of t.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function r(i){const t={};return i.integrity&&(t.integrity=i.integrity),i.referrerPolicy&&(t.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?t.credentials="include":i.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(i){if(i.ep)return;i.ep=!0;const t=r(i);fetch(i.href,t)}})();class A{constructor(e,r,n){this.Ip=e,this.subRedes=n,n?this.Cid=this.newCid(n):this.Cid=r,this.clase=this.Clase(),this.originalMask=this.OriginalMask(),this.binaryMask=this.BinaryMask(),this.decimalMask=this.DecimalMask(),this.numSubRed=this.NumSubRed(),this.saltos=this.Saltos(),this.numHosts=this.saltos-2,this.network=this.Network(),this.busqueda=new Object,this.numBusqueda=0,this.subRedes=new Array,n?this.SubRed(1e3):this.SubRed(this.numSubRed-1)}newCid(e){const r=Math.ceil(Math.log2(e));let n;switch(this.Clase()){case"A":n=8;break;case"B":n=16;break;case"C":n=24;break}return n+r}Clase(){if(this.Ip[0]>=1&&this.Ip[0]<=126)return"A";if(this.Ip[0]>=128&&this.Ip[0]<=191)return"B";if(this.Ip[0]>=192&&this.Ip[0]<=223)return"C"}DecimalMask(){let e=new Array;return this.binaryMask.map(r=>{e.push(this.BinaryToDecimal(r))}),e}BinaryMask(){let e=new Array;return this.originalMask.map(r=>{e.push(this.DecimalToBinary(r))}),this.MaskOfCid(e),e}NumSubRed(){switch(this.clase){case"A":return Math.pow(2,this.Cid-8);case"B":return Math.pow(2,this.Cid-16);case"C":return Math.pow(2,this.Cid-24)}}Saltos(){const e=32-this.Cid;switch(this.clase){case"A":return this.Cid>=8?Math.pow(2,e):Math.pow(2,32-8);case"B":return this.Cid>=16?Math.pow(2,e):Math.pow(2,32-16);case"C":return this.Cid>=24?Math.pow(2,e):Math.pow(2,32-24)}}OriginalMask(){switch(this.clase){case"A":return[255,0,0,0];case"B":return[255,255,0,0];case"C":return[255,255,255,0];default:return}}DecimalToBinary(e){let r=[0,0,0,0,0,0,0,0],n=-1;for(;parseInt(e)>0;)r.splice(n,1,parseInt(e%2)),n--,e=parseInt(e/2);return r}BinaryToDecimal(e){let r=0,n=0;for(let i=e.length-1;i>=0;i--)r=r+e[i]*Math.pow(2,n),n++;return r}MaskOfCid(e){switch(this.clase){case"A":this.Cid>8&&this.AddBits(1,8,e);break;case"B":this.Cid>16&&this.AddBits(2,16,e);break;case"C":this.Cid>24&&this.AddBits(3,24,e);break}}AddBits(e,r,n){let i=this.Cid-r;for(let t=e;t<=3;t++){for(let d=0;d<8&&(n[t].splice(d,1,1),i--,i!=0);d++);if(i==0)break}}Network(){let e=new Array;switch(this.clase){case"A":e=this.Ip.slice(0,1),e.push(0,0,0);break;case"B":e=this.Ip.slice(0,2),e.push(0,0);break;case"C":e=this.Ip.slice(0,3),e.push(0);break}return e}SubRed(e){let r=0,n,i=3,t=new Object;for(;this.saltos>256;)i--,this.saltos=this.saltos/256;if(n=this.saltos,t.network=structuredClone(this.Network()),t.hostMin=structuredClone(t.network),t.hostMin.splice(3,1,t.network[3]+1),t.hostMax=structuredClone(t.hostMin),this.numHosts>255?(t.hostMax.splice(i,1,t.hostMin[i]+this.saltos-1),i==2?t.hostMax.splice(3,1,254):i==1&&(t.hostMax.splice(2,1,255),t.hostMax.splice(3,1,254))):t.hostMax.splice(3,1,t.hostMin[3]+this.numHosts-1),t.broadcast=structuredClone(t.hostMax),t.broadcast.splice(3,1,t.hostMax[3]+1),this.subRedes.push(t),e!=1e3&&this.isSubred(this.subRedes[r].broadcast)){this.busqueda=t,this.numBusqueda+=r+1;return}for(;r<this.numSubRed-1&&r<e;){if(t=new Object,t.network=new Array,t.network=structuredClone(this.subRedes[r].broadcast),t.hostMin=new Array,t.hostMax=new Array,t.broadcast=new Array,r++,this.subRedes[this.subRedes.length-1].broadcast[3]>=255&&(t.network.splice(2,2,this.subRedes[this.subRedes.length-1].broadcast[2]+1),t.network.push(0)),this.subRedes[this.subRedes.length-1].broadcast[2]>=255&&(t.network.splice(1,3,this.subRedes[this.subRedes.length-1].broadcast[1]+1),t.network.push(0),t.network.push(0)),t.network.splice(i,1,n),t.hostMin=structuredClone(t.network),t.hostMin.splice(3,1,t.network[3]+1),t.hostMax=structuredClone(t.hostMin),this.numHosts>255?(t.hostMax.splice(i,1,n+this.saltos-1),i==2?t.hostMax.splice(3,1,254):i==1&&(t.hostMax.splice(2,1,255),t.hostMax.splice(3,1,254))):t.hostMax.splice(3,1,t.hostMin[3]+this.numHosts-1),t.broadcast=structuredClone(t.hostMax),t.broadcast.splice(3,1,t.hostMax[3]+1),n+=this.saltos,this.subRedes.push(t),e!=1e3&&this.isSubred(this.subRedes[r].broadcast)){this.busqueda=t,this.numBusqueda+=r+1;return}n>255&&(n=0)}}isSubred(e){return this.Ip[3]<=e[3]&&this.Ip[2]<=e[2]&&this.Ip[1]<=e[1]}}const m=document.getElementById("calcular"),b=document.getElementById("buscar"),T=document.getElementById("limpiar"),c=document.getElementById("ip"),a=document.getElementById("mascara"),l=document.getElementById("subredes"),o=document.getElementById("contenido"),w=document.getElementById("espera"),f=document.getElementById("subir");window.addEventListener("scroll",s=>{window.scrollY>=2e3?f.style.display="flex":f.style.display="none"});f.children[0].addEventListener("click",s=>{window.scroll(0,0)});c.addEventListener("keydown",s=>{isNaN(s.key)&&s.key!="."&&s.key!="Backspace"&&s.key!="ArrowLeft"&&s.key!="ArrowRight"&&s.key!="Tab"?s.preventDefault():(c.classList.remove("border","border-danger","border-2"),a.classList.remove("border","border-danger","border-2"))});a.addEventListener("keydown",s=>{M(a,s)});l.addEventListener("keydown",s=>{M(l,s)});l.addEventListener("focusout",s=>{l.value!=""?m.removeAttribute("disabled"):m.setAttribute("disabled","")});a.addEventListener("focusout",s=>{a.value!=""?b.removeAttribute("disabled"):b.setAttribute("disabled","")});b.addEventListener("click",s=>{const e=parseInt(a.value,10);let r;s.preventDefault;let n=document.getElementById("error");if(n&&n.remove(),o.children.length>0&&o.removeChild(o.children[0]),a.value==""){a.classList.add("border","border-danger","border-2"),o.style.display="none";return}if(e>32||e<8){y("ERROR en la mascara ",a.value),o.style.display="none";return}if(r=x(c,e),r)w.remove(),o.style.display="flex",o.appendChild($(r)),o.addEventListener("load",()=>{});else return});m.addEventListener("click",s=>{const e=parseInt(l.value,10);let r;if(s.preventDefault,o.children.length>0&&o.removeChild(o.children[0]),c.value==""){c.classList.add("border","border-danger","border-2");return}if(r=x(c,0,e),r)w.remove(),o.appendChild(O(r)),o.style.display="flex";else return});T.addEventListener("click",s=>{c.value="",a.value="",l.value="",b.setAttribute("disabled",""),m.setAttribute("disabled",""),location.reload()});function M(s,e){isNaN(e.key)&&e.key!="Backspace"&&e.key!="ArrowLeft"&&e.key!="ArrowRight"&&e.key!="Tab"?e.preventDefault():s.classList.remove("border","border-danger","border-2")}function S(s){if(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(s)){let r=document.getElementById("error");return r&&r.remove(),!0}else return y("ERROR en la ip ",s),!1}function x(s,e,r){let n;if(S(s.value)){if(n=s.value.split("."),n[0]==127){y("Error en la ip, esta reservada para loopback ",s.value),o.style.display="none";return}return n=n.map(function(i){return Number(i)}),new A(n,e,r)}else o.style.display="none",document.getElementsByTagName("main")[0].appendChild(w)}function y(s,e){const r=document.getElementById("formulario");let n=document.getElementById("error");const i=document.createTextNode(s+e);n&&n.remove(),n=document.createElement("p"),n.appendChild(i),n.id="error",n.classList.add("text-center"),r.appendChild(n)}function O(s){const e=document.createElement("div");let r=0;for(e.appendChild(N(s));r<s.subRedes.length;)e.appendChild(v(s.subRedes[r],s,r)),r++;return e.classList.add("w-100","d-flex","flex-column","align-items-center"),e}function $(s){const e=document.createElement("div");return e.classList.add("w-100","d-flex","flex-column","align-items-center"),e.appendChild(N(s)),e.appendChild(v(s.busqueda,s,s.numBusqueda-1)),e}function v(s,e,r){const n=document.createElement("table"),i=document.createTextNode("Network"),t=document.createTextNode("HostMin"),d=document.createTextNode("HostMax"),g=document.createTextNode("Broadcast"),E=document.createTextNode(`${s.network.join(".")}/${e.Cid}`),B=document.createTextNode(`${s.hostMin.join(".")}`),I=document.createTextNode(`${s.hostMax.join(".")}`),R=document.createTextNode(`${s.broadcast.join(".")}`),C=document.createElement("thead"),u=document.createElement("tbody"),k=document.createElement("tr"),p=document.createElement("th"),L=document.createTextNode(`Subred ${r+1}`);return n.classList.add("table","table-striped"),p.classList.add("table-info","text-center"),p.setAttribute("colspan","2"),p.appendChild(L),k.appendChild(p),C.appendChild(k),u.appendChild(h(i,E)),u.appendChild(h(t,B)),u.appendChild(h(d,I)),u.appendChild(h(g,R)),n.appendChild(C),n.appendChild(u),n}function h(s,e){const r=document.createElement("tr"),n=document.createElement("th"),i=document.createElement("td");return n.classList.add("text-center","w-50"),i.classList.add("text-start","w-50"),n.appendChild(s),i.appendChild(e),r.appendChild(n),r.appendChild(i),r}function N(s){const e=document.createElement("table"),r=document.createElement("tbody"),n=[{nombre:document.createTextNode("Ip"),textNodo:document.createTextNode(`${s.network.join(".")}`)},{nombre:document.createTextNode("Clase"),textNodo:document.createTextNode(`${s.clase}`)},{nombre:document.createTextNode("Mascara"),textNodo:document.createTextNode(`${s.originalMask.join(".")}`)},{nombre:document.createTextNode("Nueva mascara"),textNodo:document.createTextNode(`${s.decimalMask.join(".")}/${s.Cid}`)},{nombre:document.createTextNode("Numero de hosts por subred"),textNodo:document.createTextNode(`${s.numHosts}`)},{nombre:document.createTextNode("Numero de subredes"),textNodo:document.createTextNode(`${s.numSubRed}`)}];for(let i=0;i<=5;i++)r.appendChild(h(n[i].nombre,n[i].textNodo));return e.classList.add("table","table-striped","table-warning"),e.appendChild(r),e}
